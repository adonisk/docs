<!DOCTYPE html>
<html>

  

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

		<title>
			 Notification API 
		</title>
    
		<meta name="description" content="Receiving post transaction notifications via JSON API callback">
    <meta name="author" content="">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap styles -->
    <link rel="stylesheet" href="/docs/css/bootstrap.min.css">
    <link rel="stylesheet" href="/docs/css/bootstrap-theme.min.css">
    
    <!-- Custom styles -->
    <link rel="stylesheet" href="/docs/css/style.css" type="text/css" media="all">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="/docs/js/bootstrap.min.js"></script>
</head>



  <body>

    
<header class="site-header">

	<nav class="navbar navbar-default navbar-fixed-top">
  	<div class="container-fluid">
    	<!-- Brand and toggle get grouped for better mobile display -->
    	<div class="navbar-header">
      	<a class="navbar-brand" href="/docs/">
					<img alt="Brand" src="/docs/images/eze-logo-white.png">
				</a>
    	</div>

    	<!-- Collect the nav links, forms, and other content for toggling -->
    	<div class="collapse navbar-collapse navbar-inverse" id="bs-example-navbar-collapse-1">
				<ul class="nav navbar-nav">
      		<li><h3><span style="color:white">Developers</span></h3></li>
				</ul>
    		<ul class="nav navbar-nav navbar-right">
					
						<li class="dropdown">
          		<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" 
								aria-haspopup="true" aria-expanded="false">Client Side <span class="caret"></span></a>
							<ul class="dropdown-menu">
								
									
								
									
								
									
								
									
								
									
        						<li><a href="/docs/pages/sdk-android-hybrid.html">Android SDK - Hybrid JS</a></li>
									
								
									
        						<li><a href="/docs/pages/sdk-android-native.html">Android SDK - Native</a></li>
									
								
									
        						<li><a href="/docs/pages/sdk-windows.html">Windows SDK</a></li>
									
								
							</ul>
						</li>
					
						<li class="dropdown">
          		<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" 
								aria-haspopup="true" aria-expanded="false">Server Side <span class="caret"></span></a>
							<ul class="dropdown-menu">
								
									
        						<li><a href="/docs/pages/api-notification.html">Notification API</a></li>
									
								
									
								
									
								
									
								
									
								
									
								
									
								
							</ul>
						</li>
					
						<li class="dropdown">
          		<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" 
								aria-haspopup="true" aria-expanded="false">Help <span class="caret"></span></a>
							<ul class="dropdown-menu">
								
									
								
									
        						<li><a href="/docs/pages/faq-home.html">FAQ</a></li>
									
								
									
								
									
								
									
								
									
								
									
								
							</ul>
						</li>
					
					<li><a href="/docs/" style="color:white"><i class="glyphicon glyphicon-home"></i> Home</a></li>
					<li>""</li>
    		</ul>
  		</div>
		</div>
	</nav>
</header>

    <div class="container container-fluid">
			<div class="row">
				<div class="col-md-1 leftnav">
				</div>
				<div class="col-md-10 page">
					<div class="page-header">
						<h1>Notification API&nbsp;<small>Receiving post transaction notifications via JSON API callback</small></h1>
					</div>
					<div class="page-content">
						<p>This document describes how Ezetap customers can integrate with <code>Ezetap Notification API</code> to receive notifications when payment transactions are posted in the Ezetap server. This can also be used to reconcile customer’s enterprise systems when payment transactions are done against their business transactions. Once setup, these notification will be posted to the customer provided API end points. Both <code>success</code> and <code>failure</code> transactions will be posted on these end points.</p>

<h4 id="how-to-activate-notification-api">How to activate Notification API</h4>

<ol>
  <li>Customer should expose a <code>HTTP/POST</code> end point accepting <code>JSON message body</code></li>
  <li>Notification API needs to be enabled for the merchant on the merchant portal</li>
</ol>

<p>Ezetap sends a POST message on the customer’s API end point and waits for a HTTP/Success response (Status 200). In case a HTTP Success is not received (<code>due to various reasons, including network connectivity, timeout etc.</code>), Ezetap will retry upto 3 times (at an interval of 10 minutes each). If no HTTP/Success response is received after the 3 attempts, the notification is marked as FAILED and no additional attempts will be made.</p>

<pre><code>There may be scenarios when the customer has received the notification and processed them, but failed in responding to Ezetap. In such cases, Ezetap will keep retrying. In such cases, customer's application should be able to handle (and ignore) duplicate notifications for the same transaction.
</code></pre>

<blockquote>
  <p>NOTE: Over time, the Notification API may be upgraded with additional parameters. These additional parameters will be optional and will not impact existing customers. But the customer’s API end point should be able to handle (and ignore) these additional optional parameters. This is to ensure merchant’s application doesn’t break when new attributes are introduced in the notification API.</p>
</blockquote>

<h2 id="api-documentation">API Documentation</h2>

<p>The API end point needs to conform to the following specification.</p>

<p>The following headers are sent in the HTTP request.</p>

<pre><code>URL: Any Customer URL (REST API)
HTTP Method: POST
Content-Type: application/json
Request Body: JSON encoded key-value pairs are sent in the request body.
</code></pre>

<p>JSON structure for different events and processes are documented below. Some fields are optional, for e.g. Cheque payment related fields (bank details etc) will be populated only for cheque transactions. Card related fields will be populated only for Card payment.</p>

<h3 id="json-specification">JSON Specification</h3>

<p>JSON that will be posted will have this structure.</p>

<pre><code>{
		"amount": 2,
	"amountAdditional": 0,
		"amountCashBack": 0,
	"amountOriginal": 2,
	"authCode": "D40533",
	"batchNumber": "1",
	"currencyCode": "INR",
	"customerName": "John Doe",
	"customerReceiptUrl": "http://192.168.1.106/portal/r/o/MnicpI6h",
	"deviceSerial": "010001009702",
	"externalRefNumber": "order-01",
	"formattedPan": "4386-28XX-XXXX-4009",
	"invoiceNumber": "2",
	"mid": "FG-DUMMY-MID",
	"payerName": "John Doe",
	"paymentCardBrand": "VISA",
	"paymentCardType": "CREDIT",
	"paymentMode": "CARD",
	"pgInvoiceNumber": "2",
	"postingDate": 1423861938000,
	"rrNumber": "RR40533",
	"settlementStatus": "PENDING",
	"stan": "2",
	"status": "AUTHORIZED",
	"tid": "TERM-0",
	"txnId": "150214024218252E010000028",
	"txnType": "CHARGE",
	"userAgreement": "I agree to pay as per ... and receive chargeslip ...",
	"username": "9111111111"
	}
</code></pre>

<h3 id="field-descriptions">Field Descriptions</h3>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Data type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>amount</td>
      <td>double</td>
      <td>total amount</td>
    </tr>
    <tr>
      <td>amountAdditional</td>
      <td>double</td>
      <td>additional amount. for e.g. tip</td>
    </tr>
    <tr>
      <td>amountOriginal</td>
      <td>double</td>
      <td>original amount</td>
    </tr>
    <tr>
      <td>amountCashBack</td>
      <td>double</td>
      <td>cash back amount</td>
    </tr>
    <tr>
      <td>authCode</td>
      <td>string</td>
      <td>authorization code given by the card issuing bank</td>
    </tr>
    <tr>
      <td>batchNumber</td>
      <td>string</td>
      <td>batch no. of the transaction</td>
    </tr>
    <tr>
      <td>currencyCode</td>
      <td>string</td>
      <td>currency code of the merchant</td>
    </tr>
    <tr>
      <td>customerName</td>
      <td>string</td>
      <td>customer’s name</td>
    </tr>
    <tr>
      <td>customerReceiptUrl</td>
      <td>string</td>
      <td>customer receipt url</td>
    </tr>
    <tr>
      <td>deviceSerial</td>
      <td>string</td>
      <td>serial no. of the device used for card payment</td>
    </tr>
    <tr>
      <td>externalRefNumber</td>
      <td>string</td>
      <td>reference no. it is generated if not provided</td>
    </tr>
    <tr>
      <td>formattedPan</td>
      <td>string</td>
      <td>payment card’s pan with first 6 and last 4 digits</td>
    </tr>
    <tr>
      <td>invoiceNumber</td>
      <td>string</td>
      <td>invoice no. of the transaction</td>
    </tr>
    <tr>
      <td>mid</td>
      <td>string</td>
      <td>MID used for the transaction</td>
    </tr>
    <tr>
      <td>payerName</td>
      <td>string</td>
      <td>payer’s name</td>
    </tr>
    <tr>
      <td>paymentCardBrand</td>
      <td>string</td>
      <td>card brand. Valid values: VISA, MASTER_CARD, DISCOVER, DINERS, AMEXJCB, UNKNOWN</td>
    </tr>
    <tr>
      <td>paymentCardType</td>
      <td>string</td>
      <td>payment card’s type CREDIT, DEBIT, UNKNOWN</td>
    </tr>
    <tr>
      <td>paymentMode</td>
      <td>string</td>
      <td>payment mode. valid values: CARD, CASH, CHEQUE</td>
    </tr>
    <tr>
      <td>pgInvoiceNumber</td>
      <td>string</td>
      <td>invoice no. of the transaction, as provided by payment gateway</td>
    </tr>
    <tr>
      <td>postingDate</td>
      <td>long</td>
      <td>transactions date, time in milliseconds from epoch</td>
    </tr>
    <tr>
      <td>rrNumber</td>
      <td>string</td>
      <td>rrn of the transaction provided by payment gateway</td>
    </tr>
    <tr>
      <td>settlementStatus</td>
      <td>string</td>
      <td>settlement status of the transaction</td>
    </tr>
    <tr>
      <td>status</td>
      <td>string</td>
      <td>Transaction status. valid values: AUTHORIZED, REFUND_PENDING, AUTHORIZED_REFUNDED, REFUNDED, VOIDED, VOID_PENDING, FAILED</td>
    </tr>
    <tr>
      <td>tid</td>
      <td>string</td>
      <td>TID used for the transaction</td>
    </tr>
    <tr>
      <td>txnId</td>
      <td>string</td>
      <td>transaction ID</td>
    </tr>
    <tr>
      <td>txnType</td>
      <td>string</td>
      <td>transaction type. valid values CHARGE, REFUND, CASH_BACK, CASH_OUT</td>
    </tr>
    <tr>
      <td>userAgreement</td>
      <td>string</td>
      <td>Agreement on which card holder needs to sign if required.</td>
    </tr>
    <tr>
      <td>username</td>
      <td>string</td>
      <td>username of the user that did the transaction</td>
    </tr>
    <tr>
      <td>errorCode</td>
      <td>string</td>
      <td>Ezetap errorCode in case the transaction failed.</td>
    </tr>
    <tr>
      <td>errorMessage</td>
      <td>string</td>
      <td>Error message shown to the user in case the transaction failed.</td>
    </tr>
  </tbody>
</table>


					</div>
					<div class="cos-md-1 rightnav">
					</div>
				</div>
			</div>
		</div>
        <div id="footer">
      <div class="container">
        <p>&copy; 2015 
					<a href="http://www.ezetap.com" target="_blank">Ezetap Mobile Solutions Private Limited.</a>
        </p>
      </div>
    </div>

  </body>

</html>

